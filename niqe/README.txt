Code borrowed and simplified from https://github.com/sophgo/TPU-Coder-Cup/tree/main/CCF2023/metrics
